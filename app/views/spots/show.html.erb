<% content_for(:title, @spot.spot_name) %>
<div class="container mx-auto px-36">
  <div class="mb-8">
    <h1 class="text-xl font-bold mb-2"><%= t(".title") %></h1>
    <hr>
  </div>

  <div class="mx-auto">
    <% if @spot.images.present? %>
      <div class="flex justify-center mb-10">
        <div class="carousel custom-carousel overflow-hidden rounded-lg shadow hover:shadow-lg transition duration-300">
          <% @spot.images.each_with_index do |spot, i| %>
            <div id="slide<%= i + 1 %>" class="carousel-item relative">
              <%= image_tag (spot.url), class: "object-cover w-full h-full" %>
              <% if @spot.images.size >= 2 %>
                <div class="absolute flex justify-between transform -translate-y-1/2 left-2 right-2 top-1/2">
                  <% prev_index = i > 0 ? i : @spot.images.size %>
                  <% next_index = i + 2 <= @spot.images.size ? i + 2 : 1 %>
                  <a href="#slide<%= prev_index %>" class="btn btn-circle">❮</a>
                  <a href="#slide<%= next_index %>" class="btn btn-circle">❯</a>
                </div>
              <% end %>
            </div>
          <% end %>
        </div>
      </div>
    <% end %>

    <div class="px-18">
      <div class="mb-4">
        <div class="flex flex-wrap items-center mb-2">
          <h1 class="text-3xl mr-4"><%= @spot.spot_name %></h1>
          <div class="badge badge-lg bg-amber-300 border-none"><%= @spot.tag_i18n %></div>
        </div>
        <h2 class="text-2xl"><%= @spot.artist.name %></h2>
      </div>
      <section class="mb-4">
        <h3 class="text-base font-bold mb-1"><%= t(".detail") %></h3>
        <p><%= simple_format(@spot.detail) %></p>
      </section>
    </div>

    <div class="mb-8 px-18">
      <div class="mb-2">
        <h3 class="text-base font-bold mb-2"><%= t(".address") %></h3>
        <p><%= @spot.address %></p>
      </div>
      <div id="map" class="h-96 rounded-md"></div>
    </div>

    <div class="flex flex-row justify-between items-center mb-4">
      <div class="flex items-center">
        <div class="text-lg mr-2"><%= t(".create_user") %>：</div>
        <div class="mr-2">
          <%= @spot.user.name %>
        </div>
        <div class="avatar">
          <div class="w-10 rounded-full">
            <%= image_tag @spot.user.avatar_url %>
          </div>
        </div>
      </div>
      <% if logged_in? && current_user.own?(@spot) %>
        <%= link_to "https://twitter.com/share?url=%0a#{request.url}&text=MusicMap%0a#{@spot.spot_name}/#{@spot.artist.name}", target: "_blank", title: "Xでシェア" do %>
          <i><%= image_tag "logo-white.png", class: "w-10 rounded-lg bg-black p-2 m-2" %></i>
        <% end %>
      <% end %>
    </div>

  <div class="flex items-center justify-end mr-2 mb-20">
    <% if logged_in? && current_user.own?(@spot) %>
      <%= link_to t(".spot_edit"), edit_spot_path(@spot), data: { turbo: false }, class: "btn-primary" %>
    <% end %>
  </div>

    <div class="mb-8">
      <hr>
    </div>

    <%= render "comments/form", comment: @comment, spot: @spot %>

    <div id="comments-list" class="flex flex-col mb-20">
      <% if @comments.present? %>
        <%= render @comments %>
      <% else %>
        <div id="none-comments" class="mb-3 px-2"><%= t(".none_comment") %></div>
      <% end %>
    </div>
  </div>
</div>

<%= javascript_import_module_tag "show" %>

<script src="https://maps.googleapis.com/maps/api/js?key=<%= ENV['GOOGLE_MAP_API_KEY'] %>&callback=initMap" defer></script>
